clear; clc;
soc_range = [0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9]; % soc levels
soc_init = 0.9*ones(1,16);
temp_range = [10,20,30,40]; % (deg C)
temp_init = 25; % (K)
deltaT = 0.05;

% cell charging ocv (Volts)
ocv_charge = [3.411,3.4045,3.405,3.406;
3.529,3.524,3.524,3.525;
3.589,3.589,3.59,3.592;
3.638,3.638,3.639,3.642;
3.706,3.7055,3.708,3.711;
3.832,3.8295,3.83,3.831;
3.916,3.915,3.916,3.916;
4.006,4.007,4.007,4.008;
4.086,4.085,4.086,4.087;]; 

% cell discharging ocv (Volts)
ocv_discharge = [3.387,3.3855,3.385,3.385;
3.502,3.4965,3.497,3.496;
3.577,3.577,3.579,3.581;
3.625,3.627,3.629,3.631;
3.69,3.6925,3.695,3.697;
3.818,3.821,3.822,3.822;
3.907,3.908,3.909,3.909;
3.999,4.001,4.002,4.001;
4.082,4.082,4.083,4.084;]; 

% module net ocv (Volts)
ocv_net = (ocv_charge + ocv_discharge)*12/2; 

% module discharge ohmic resistance (mOhms)
ohmic_res_discharge = [6.556865079,5.427333333,4.425111111,4.245777778;
6.736222222,4.936444444,4.090222222,3.833333333;
6.437777778,4.825111111,4.026444444,3.717555556;
6.242666667,4.778666667,4.016888889,3.682888889;
6.124666667,4.717555556,3.981777778,3.659111111;
6.014666667,4.696444444,3.976888889,3.645333333;
6.031555556,4.749111111,4.026,3.652666667;
6.105555556,4.805333333,4.064666667,3.659333333;
6.238666667,4.984,4.215555556,3.686;];  

% module charge ohmic resistance (mOhms)
ohmic_res_charge = [6.498281089,5.36625,4.38375,4.21925;
6.6835,4.9205,4.08975,3.83175;
6.43,4.7845,4.00025,3.707;
6.2075,4.73925,3.97275,3.6355;
6.0905,4.68725,3.95975,3.653;
5.9875,4.671,3.98175,3.64525;
6.01475,4.696,3.987,3.63075;
6.13373494,4.771,4.0528,3.6476;
6.269277108,4.9445,4.174,3.6932;];

module_capacity = 155; % module capacity (Ahr)

% module first polarization discharging resistance (mOhm)
first_pol_res_discharge = [1.196117703,3.652046781,1.438472652,1.515799628;
1.389884993,0.911462073,0.921369712,0.872852521;
1.085916739,0.945556684,1.124863965,1.033485234;
0.974257172,0.976517271,0.872490415,0.849795009;
0.991500501,0.936145727,0.965068532,0.830231887;
1.295774635,1.04739441,0.984676149,0.919076679;
1.069521662,1.071097242,1.021389752,0.820375886;
1.115677694,1.087186316,1.053142951,1.819136981;
1.10329358,0.963297884,0.948404842,0.944065227;];

% module first polarization charging resistance (mOhm)
first_pol_res_charge = [1.011740613,1.157493973,1.120500531,1.057278937;
1.07803289,1.015151947,1.179790798,1.1851649;
1.068982115,1.317496899,0.905365184,0.730592839;
1.046575326,1.087376363,0.816430772,0.709556459;
1.120669603,1.219276968,0.99931082,1.006460619;
1.116541377,1.00054805,1.064387601,0.996740661;
1.193899982,0.973102904,1.182420027,0.864515152;
1.068900462,1.340802796,0.869443726,1.113073299;
1.323151159,1.287226023,1.081679962,0.786446026;];

% module first polarization resistance (mOhm)
first_pol_res = ((first_pol_res_charge + first_pol_res_discharge)/2);

% module first discharging time constant (s)
first_time_const_discharge = [3.717371349,2.144729973,3.752058603,5.039913857;
3.451056594,1.846996869,4.244801924,3.839964635;
3.413610842,4.1565828,7.450070944,7.227897732;
3.384329101,4.507575133,4.33970288,6.02812279;
3.068383706,3.656391351,5.225483334,5.263016047;
3.393945354,2.809213155,2.994032551,3.231134394;
1.963928581,0.607444896,2.542686547,3.789372366;
2.765328179,1.45053341,2.821620883,14.20102314;
2.56533065,1.639216179,3.747637345,5.923602766;];

% module first charging time constant (s)
first_time_const_charge = [2.158277377,1.626642958,4.995244995,4.579207237;
2.869352764,4.833565364,7.893915501,7.998763516;
4.016044497,8.971429932,6.092001095,3.616462552;
3.547181941,6.604213801,4.60164987,3.16991698;
2.997045358,7.169547118,6.194095044,6.216978978;
3.060551501,3.670575054,6.045154158,6.406925686;
4.550782316,3.933510332,7.782498587,4.949804473;
4.239560491,7.355429073,3.026459268,8.035968946;
7.412917522,8.318762929,7.61055854,5.599352742;];

% module first time constant (s)
first_time_const = ((first_time_const_charge + first_time_const_discharge)/2);

% module second polarization resistance (mOhm)
second_pol_res = [4.604829812,6.347286942,4.126604008,2.619409304;
4.996666004,5.185872507,3.534980449,2.947016037;
5.315389773,5.435822924,4.559893677,2.611319802;
5.944556045,4.282936753,3.668145483,3.109287382;
8.075372509,3.818331021,3.054914021,3.854715936;
5.024944352,7.959339821,7.002858338,2.149965374;
5.477816307,5.883096599,4.463121331,2.535612915;
6.925738314,4.160172172,3.148238348,3.423999612;
9.184258127,5.131371379,4.436334134,4.12221142;];

% module second time constant (s)
second_time_const = [40.67022316,56.02552642,36.52111786,22.9437206;
44.15553664,45.75656441,31.37827638,25.94685025;
47.03259995,48.47188966,40.41716735,22.75983909;
52.30608973,38.04321509,32.69827941,27.44485716;
71.76125988,34.07488671,26.80465306,34.45659592;
44.44497018,70.75796606,61.9801045,18.72954025;
48.58299248,52.15224106,39.39162452,22.27158048;
61.17184086,37.00421022,27.95411968,30.55379108;
81.3777808,45.73504839,39.22671812,36.57201848;];